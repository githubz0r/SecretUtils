---
title: "transmute_code_eps_2"
author: "githubz0r"
date: "2019-04-29"
output: workflowr::wflow_html
---

```{r}
#editor_options:
  #chunk_output_type: inline
```


load packages and data
```{r}
library(conos)
library(parallel)
library(ggplot2)
library(Matrix)
library(data.table)
library(pagoda2)
library(cowplot)
library(dplyr)
library(abind)
library(tidyr)
require(Rtsne)
source('/home/larsc/SecretUtils/R/asdf.R')
source('/home/larsc/SecretUtils/R/peter_code_utils.R')

con <- readRDS(file.path('/home/larsc/data/10x_preproced_graphed.rds'))
con <- Conos$new(con)
annot <- readRDS(file.path('/home/demharters/R/projects/UPF9_14_17_19_22_23_24_32_33/metadata_10x_final.rds'))
fraction_palette_eps <- c(epilepsy='hotpink', healthy='seagreen') 

```

'Fractional' changes.
```{r}
FractionalPlot(annot, 1, 2 ,3, fraction.palette=fraction_palette_eps)
```

Distance matrix tsne plot
```{r}
annot2 <- annot %>% mutate(cellid=rownames(annot))

ctdm<- Makectdm(con, annot2, 1, 2, 4)

PlotDistanceMatRed(ctdm, annot2, 1, 2, 1, 4, 3, perplexity=2, max_iter=1e3)
```

Distribution distances per cell type (using ctdm so must be unweighted)
```{r}
min_cells=0
PlotCellTypeDists(ctdm, min_cells)
```

